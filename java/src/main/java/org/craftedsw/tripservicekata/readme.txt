Work through kata

* Apply automatic fixes, format etc.
* Extract singleton calls to methods, use Test specific subclass.
* Create full test
* Simplify code in itself
* Move out Feature Envy
* Move out other concerns (security)
